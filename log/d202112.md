# ログ

[ログ一覧](index.html)

## [12月23日(木)](#23) <a id="23"></a>

* 富岳確認
* 卒論日程確認
* 修論日程確認
* 委嘱状確認
* 要旨確認

なんか学生さんがサーバ落としたり、それまで知られてなかったスパコンのリソース上限にひっかかったりしていて頼もしい。このまま成長してスパコンブレイカーになってください。
 
## [12月22日(水)](#22) <a id="22"></a>

ホワイトボード届いた。

学部のシラバス、英文も作成したほうが良いらしい。

集中講義のシラバス作らないと。こんな感じかな。

タイトル案：大規模数値計算が拓く物理学

シラバス案

1. 数値計算の基礎
    * なぜ数値計算が必要なのか？
    * 数値実験とはどのような実験か？
    * 数値計算の種類
2. モンテカルロ法(1)基礎的な話題 
    * 乱数とはなにか
    * モンテカルロ法
    * マルコフ連鎖モンテカルロ法とメトロポリス法
    * エラーバーについて
3. モンテカルロ法(2) 発展的な話題
    * クラスターアルゴリズムとImproved Estimator
    * 不偏推定量とJackknife法
4. 分子動力学法(1) 基礎編 (主に数値積分法について)
    * 微分方程式の数値積分法
    * シンプレクティック積分
    * 温度制御(Langevin, Nose-Hoover)
5. 分子動力学法(2) 応用編(研究事例紹介)
    * 気液共存線の決定
        * 相転移とは
        * 有限サイズスケーリング
    * 気泡生成現象
        * 界面張力とは
        * 気泡成長の理論
6. 並列計算の基礎と高速化について
    * 計算機の仕組み
    * 高速化 (メモリ効率)
    * 並列化
    * SIMD化
7. スパコンでできること、できないこと(どこかでセミナー形式?)
    * 大規模並列計算による多重気泡生成現象の解析(泡バブルの話)
    * スーパーコンピュータを使って難しいナンプレを作る(数独で炎上した話)

ダメだ、今日もタスクを積み残したぞ。ヤバい。

## [12月21日(火)](#21) <a id="21"></a>

論文再投稿準備。なんかLaTeXファイルにAtomが関連付けられてるな。

また仕事でミス。最近多すぎる。完全に後手に回っている。

[Zennのおかしなエラーバーの記事](https://zenn.dev/kaityo256/articles/weird_errorbars)、そこそこ評判良かったみたいで安心した。やっぱりQiitaの記事の書き方よくなかったんだな。

講義。年内最後。

打ち合わせ。

PTEP投稿覚書。アカウントがなかったので作った。

* Section: Paper 
* Subject Index Section: A General and Methematical Physics (次のMore Specificによりこれ確定)
* More Specific Subject Index: 「A40 Critical phenomena, phase diagrams, phase transitions」と「A42 Classical spins」
* Category: Theoretical
* Title: 入力

あれ？Suggested Refereeを入れるところがなかったぞ。

## [12月20日(月)](#20) <a id="20"></a>

名古屋大学スパコン、郵送出した。本買った。要旨見た。

## [12月19日(日)](#19) <a id="19"></a>

しこたま寝た。最近ギアを上げ気味に走っているので疲れている。仕事時間は短いんだけど・・・。

## [12月18日(土)](#18) <a id="18"></a>

要旨見た、

そんな時間はないのだが、どうしても気になったので[おかしなエラーバーのグラフ](https://zenn.dev/kaityo256/articles/weird_errorbars)の記事を書いた。以前[Qiitaに書いた奴](https://qiita.com/kaityo256/items/197a4811e5694dacfa04)が、いまいち本質が伝わっていない気がして。

VimでPythonを書いてて、`numpy.random`が無いと言われる。どうやらPylintの静的解析に問題があるようだ。`~/.pylintrc`に、

```txt
extension-pkg-whitelist = numpy
```

と書いて解決。

## [12月17日(金)](#17) <a id="17"></a>

よく寝た。だいぶ体力を回復した。だがやるべきことが大量にある。

名大の奴、事務に出した。返ってきたら申請。

キーボード届いた。赤軸*2。こちらは静かかな？

浅野さんの論文、arXivへのリンクをウェブに公開。遅くなってしまった。

[arXiv:2112.07139](https://arxiv.org/abs/2112.07139)

良い仕事だと思うんだけど、査読者はどう見るかな。

エラーバーについての記事、絶対必用だな。Qiitaに書いた奴をリファインしてZennに書き直そう(←いつやるの？)。

要旨 * 2。

分子シミュレーション学会年会費払った。

学科計算機のお仕事。

プログラミング基礎同演習講義録画。あと一回。年内に録画しよう。

物性研スパコン共同利用報告会所外委員の仕事もしたぞ。

なんかメールいっぱい書いた・・・

要旨 * 3。

## [12月16日(木)](#16) <a id="16"></a>

研究室ミーティング。

1on1 * 4。

書類*2。

学習指導お仕事。

要旨*2。

## [12月15日(水)](#15) <a id="15"></a>

会議 * 2。その準備と後始末でもう18:40ですって。

Canvasで普段使わない機能を使ったら、機能について誤解していてミスってしまった。冒険すべきでなかった。

ホワイトボードの注文した。

名大スパコンの申請書書いた。経理責任者の問い合わせメール書いた。返事が来たらすぐ提出！

## [12月14日(火)](#14) <a id="14"></a>

プログラミング基礎同演習。

しまった、富岳の期限が切れてしまった。

## [12月13日(月)](#13) <a id="13"></a>

会議。

1on1 * 2。

学習指導のお仕事。組み合わせ最適化問題。

## [12月12日(日)](#12) <a id="12"></a>

論文見た。

CPCからソースファイルもアップロードしろ、という連絡が。あれ？CPCのガイドラインでは、最初はPDFだけで良くて、ソースはFinal Publication Processだけで良い、みたいなこと書いてあったんだけどな。とりあえず「I apologize for my incomplete submission. I have also attached the LaTeX source file.」とか書いて再投稿。

## [12月11日(土)](#11) <a id="11"></a>

プログラム基礎同演習のレポート採点。

学習指導の確認。まだいろいろわかってない。

とあるサイトで技術記事に見せかけた妄想を垂れ流し、最終的に運営にBANされた人がいて。この人、エゴサして絡んでくるから「名前を言ってはいけないあの人」みたいな扱いになってて。今日、久しぶりにその人の動向を見かけたんだけど、やっぱりすごいな。ネットで斜め読みした細切れの知識を自身の妄想で補完して作成した巨大な「新知識体系」を長文にして技術記事サイトに投稿し、ちゃんとした文献にもとづいた反論が来ると「権威主義」と切って落とす。エゴサで絡んでくるからSNSで噂話もできない。うーん。

うちの学生がこうならないようにがんばろう。

## [12月10日(金)](#10) <a id="10"></a>

ミーティングと人に会う用事合わせて6件。

以上、よろしくお願いいたします。

## [12月09日(木)](#09) <a id="09"></a>

研究室ミーティング。

LaTeXハンズオン＋卒論ガイダンス。２つ続けたので長くなってしまった。春学期のハンズオンでLaTeXをやらなかったのが敗因。

Comput. Phys. Commun.に投稿。

1. [https://www.editorialmanager.com/COMPHY](https://www.editorialmanager.com/COMPHY)に行ってAuthor Login。
2. 利用規約をacceptするをチェックして次へ
3. New Submissionsから「Submit New Manuscript」
4. プルダウンメニューから「Computational physics paper」を選ぶ。ORCIDを確認(すでに設定済みだった)してProceed
5. Cover Letterと論文のPDFをアップロード。
6. Editor: DP Landauがいない。近いっぽいJ. Adlerにする。

## [12月08日(水)](#08) <a id="08"></a>

論文一つ返したぞーーーー！

この論文、超絶塩漬け。手をつけたのが何年前だろ、と思って調べたら、2012年の4月頃に手をつけて、2012年9月に学会発表している。もうすぐ10年か・・・

プログラミング基礎同演習、11回の講義動画アップロードした。

```sh
pacman -Sy lib32-gcc-libs lib32-glibc
```

うーん、だめだ。gccで`func(f(1),f(2),f(3))`の結果をひっくり返せない。

## [12月07日(火)](#07) <a id="07"></a>

プログラミング基礎同演習。

[プログラミングというより物事が出来るようになる思考法](https://note.com/simplearchitect/n/n388201603a28)

重要だと思ったので。結局腰を据えて真面目にやるしかない、という身も蓋もない話。

論文を触る時間が全く取れない。

## [12月06日(月)](#06) <a id="06"></a>

第182回HPC研究発表会の座長。

ディスプレイ二台届いた。

## [12月05日(日)](#05) <a id="05"></a>

およ、学科分けとかの日記がない。またpush忘れか・・・。プロンプトに表示してても忘れるんだからなぁ。

遅レポの採点全部済ませた。

論文一つチェックして返した。

昨日の疲れを引きずっている。

昼寝したら、久しぶりに金縛り一歩手前に。あと、夢見が非常に悪かった。疲れてる。

論文もういっぺん、とりあえずブランチだけ切った。学生さんの論文に手がつけられない。富岳のチューニングもどうするんだ？

なんか、Twitter面倒になってきたなぁ。単に「へー」と思ったことを書いただけなのに変な絡み方されるし、本を読んで「わからん」って書いたら「そんなのわからないの？」みたいなこと言われるし。またしばらく休んだ方がいいかなあ。

## [12月04日(土)](#04) <a id="04"></a>

学科わけ説明会。物情はかなり頑張っていたのではないか。委員長のリーダーシップ(とセンス)が素晴らしい。

ただ、ずっと立ちっぱなし喋りっぱなしで疲れた。

```cpp
int a;
int b = ++a + ++a + ++a;
```

とあったときに、bがいくつになるか。gccでは10、clangでは9になる。

なぜgccで10になるかは、コンパイラに聞いてみるとわかる。

```cpp
int func(int a){
  return ++a + ++a + ++a;
}
```

というコードを書いて、抽象構文木をダンプしてやる。

```sh
gcc-10 -c -fdump-tree-all-graph test.c 
```

Macなのでgcc-10と指定している。すると、コンパイラがこのコードをどのように解釈したかが表示される。

まず、test.c.004t.originalがこうなる。

```cpp
int func(int a){
  return ( ++a +  ++a) +  ++a;
}
```

先に、左の`+`をまとめて実行する。これを`tmp1`でうけよう。

```cpp
int a = 1
int tmp1 = ++a +  ++a;
return tmp1 + ++a;
```

`tmp1 + ++a`は`tmp2`で受けよう。

```cpp
int a = 1
int tmp1 = ++a +  ++a;
int tmp2 = tmp1 + ++1;
return tmp2;
```

さて、前置インクリメントなので、`++a +  ++a`の+の実行前にインクリメントを実施する。

```cpp
// int tmp1 = ++a +  ++a;
a = a + 1;
a = a + 1;
int tmp1 = a + a;
int tmp2 = tmp1 + ++a;
return tmp2;
```

次に、`tmp1 + ++a`も同様に、先にインクリメントを実施する必要がある。

```cpp
// int tmp1 = ++a +  ++a;
a = a + 1;
a = a + 1;
//int tmp2 = tmp1 + ++a;
a = a + 1;
int tmp2 = tmp1 + a;
return tmp2;
```

最終的に、関数はこうなった。

```cpp
int func(int a){
  a = a + 1;
  a = a + 1;
  int tmp1 = a + a;
  a = a + 1;
  int tmp2 = tmp1 + a;
  return tmp2;  
}
```

というわけで、`a=1`の時には `++a + ++a + ++a = 3 + 3 + 4 = 10`になる。

clangの場合は9になる。どう解釈したかは、中間コードを見るとわかる。

```cpp
define i32 @func(i32 %0) #0 {
  %2 = %0  // %2 = 1
  %3 = %2  // %3 = 1
  %4 = %3 + 1 // %4 = 2
  %2 = %4     // %2 = 2
  %5 = %2     // %5 = 2
  %6 = %5 + 1 // %6 = 3
  %2 = %6     // %2 = 3
  %7 = %4 + %6 // %7 = 2 + 3 = 5
  %8 = %2      // %8 = 3
  %9 = %8 + 1  // %9 = 4
  %2 = %9
  %10 = %7 + %9 // %10 = 5 + 4
  return %10
}
```

つまり、clangの場合は`++a + ++a + ++a = 2 + 3 + 4 = 9`となる。

そもそも`++a + ++a`が、gccは6、clangは5になる。

gccは、

```cpp
a = a + 1
a = a + 1
return a + a;
```

と解釈する。clangは、

```cpp
%2 = %0 // %2 = 1
%3 = %2 // %3 = 1
%4 = %3 + 1 // %4 = 2
%2 = %4 // %2 = 2
%5 = %2 // %5 = 2
%6 = %5 + 1 // %6 = 3
%2 = %6
%7 = %4 + %6 // 2 + 3 = 5
```

つまり、

```cpp
tmp1 = a + 1
a = tmp1
tmp2 = a + 1
a = tmp2
return tmp1 + tmp2;
```

つまり、clangは、`++a`を、`tmp = a + 1;a = tmp`という形に受ける。

```cpp
int b = ++a + ++a;
```

は、

```cpp
tmp1 = a + 1;
a = tmp1;
tmp2 = a + 1;
a = tmp2;
int b = tmp1 + tmp2;
```

とバラす。gccは、

```cpp
a = a + 1
a = a + 1
int b = a + a;
```

とするので6になる。なるほど。

まとめると、`++a + ++a`とあった場合、GCCは、+の両側のインクリメント演算子を解決してからしてから加算を実行するが、clangは`++a`を`tmp = a + 1;a = tmp`にバラす。

理解できたかどうか、もう一度`++a + ++a + ++a`でやってみよう。

GCCの場合、まず、カッコをつける。

```cpp
return (++a + ++a) + ++a;
```

カッコをtmp1で受ける。

```cpp
int tmp1 = ++a + ++a;
return tmp1 + ++a;
```

`tmp1`を評価する際、まずインクリメント演算子を解決する。

```cpp
a = a + 1;
a = a + 1;
int tmp1 = a + a;
return tmp1 + ++a;
```

`tmp1 + ++a`のインクリメント演算子を解決する。

```cpp
a = a + 1;
a = a + 1;
int tmp1 = a + a;
a = a + 1:
return tmp1 + a;
```

以上から3+3+4=10になる。

clangの場合。

`++a`を`tmp = a + 1;a = tmp;`に変換。

```cpp
int tmp1 = a + 1;
a = tmp1;
return tmp1 + ++a + ++a;
```

次の`++a`も同様に変換。

```cpp
int tmp1 = a + 1;
a = tmp1;
int tmp2 = a + 1;
a = tmp2;
return tmp1 + tmp2 + ++a;
```

また変換。

```cpp
int tmp1 = a + 1;
a = tmp1;
int tmp2 = a + 1;
a = tmp2;
int tmp3 = a + 1;
a = tmp3;
return tmp1 + tmp2 + tmp3;
```

以上から2+3+4 = 9になる。うん、完全に理解した。

## [12月03日(金)](#03) <a id="03"></a>

プログラミング基礎同演習のレポート採点

学科わけの準備。

## [12月02日(木)](#02) <a id="02"></a>

あれ？12月になったってことは、この日記を丸一年つけたということか。気づかずに12月の日記を11月につけてた。

研究室ミーティング。phi4理論(スカラー場理論)の簡単な解説を探したんだけど、いまいち適当なのが無いなぁ。２つの基底状態を持つ系でキンク解を持つところまで簡単に説明した記事を書きたい(が、まったく時間がない)。

CDドライブ。AppleのSuperDriveをWindowsで使うには、AppleのサポートからBootCampをダウンロードして展開。中にあるBootCamp > Drivers > Apple > AppleODDInstaller64.exeを実行してインストール。これで使えるようになる。CDは、「ハードウェアの安全な取り出し」をするとeject可能。

動作確認のために古いCD-ROMを読み込んで見た。昔CDを買ってmp3に落とした奴。宇多田ヒカル、Noirのサントラ、Sash!、Evanescence・・・すべて懐かしい。Windows標準のプレイヤーで古すぎて読めなかったのでAIMPで開いた。

卒論の時期なので、LaTeXのセットアップについて書かないといけない。情報が古いからなんとかしないと。

`.latexmkrc`をホームディレクトリに置かせるか、各プロジェクトに置かせるか迷うな。とりあえずはホームか。

冬季安全点検送った。

LaTeXのインストール確認と、古い記述の修正を行った。卒論執筆ハンズオンの準備もOK。

第182回ハイパフォーマンスコンピューティング研究発表会、申し込んでなかったので申し込んだ。情報処理学会の年会費も払った。

## [12月01日(水)](#01) <a id="01"></a>

D論の説明。

年末調整の原本提出。枚数が多い場合は、簡単年調の台紙を使うより、A4を縦に使って、複数枚を一度に貼り付けた方が良いそうだ。来年はそうしよう。A4を縦にしたときに右上に赤字で名前と職員番号を印刷しておくこと。

面接。

柔道部ワークフローの提出。いろいろ慣れてなくて手間取った。練習が再開できる感じなので良かった。

キーボード注文したぞ。青軸派ですか。

物性研スパコンの来年度前期の申請した。

論文が共著者から返ってきた。直さないと。
