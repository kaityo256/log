# ログ

[ログ一覧](index.html)

## [03月19日(金)](#19) <a id="19"></a>

[Why does Windows still use NTFS? Why not ext4, the file system for Linux, since it actively prevents disk fragmentation?](https://qr.ae/pNfEhZ)。回答が面白い。[翻訳版](https://jp.quora.com/%E3%81%AA%E3%81%9CWindows%E3%81%AF%E3%81%BE%E3%81%A0NTFS%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%84%E3%82%8B%E3%81%AE%E3%81%A7%E3%81%97%E3%82%87%E3%81%86%E3%81%8B-%E3%81%AA%E3%81%9C%E3%83%95%E3%83%A9%E3%82%B0/answers/267575145?ch=2&srid=uzkoW1)もある。この「安定している」NTFSの開発にはとても苦労したことが「闘うプログラマー」からわかる。

メール処理。今週は体調がいまいちで仕事がなかなか捗らなかった。

## [03月18日(木)](#18) <a id="18"></a>

Dockerハンズオン。無事に終わった。

研究室ミーティング。僕の発表。SIMDアルゴリズムの論文紹介。
「A flexible algorithm for calculating pair interactions on SIMD architectures」
Szilárd Páll, Berk Hess, Comput. Phys. Comm. Vol. 184 2641-2650 (2013).

もう一つ僕の発表。「不偏推定量とJackknife」

本読み輪講。

## [03月17日(水)](#17) <a id="17"></a>

研究室サーバでDockerを使おうとしたら

```txt
Error response from daemon: Get https://registry-1.docker.io/v2/: net/http: request canceled while waiting for connection (Client.Timeout exceeded while awaiting headers)
```

と言われて死んでいる。どうしよう？

`etc/resolv.conf`に

```txt
nameserver 8.8.8.8
```

を追加したら通った。デフォルトのnameserverがおかしい？

明日のDockerハンズオンの準備完了。

明日のもう一つのスライド作った。SIMDのクラスターアルゴリズムについて。

## [03月16日(火)](#16) <a id="16"></a>

体調があまりよろしくない。

木曜日のスライド作り終わった。いろいろギリギリだな。

## [03月17日(月)](#15) <a id="15"></a>

木曜日の発表の準備。スケーリング次元とか完全に忘れてた。

## [03月14日(日)](#14) <a id="14"></a>

NOP

Yahooトップページの広告に「ねじのおはなし」という広告があり、おそらく生まれて初めて自分の意思で広告をクリックした。飛んだ先は鍋屋バイテック株式会社の[ねじのおはなし](https://www.nbk1560.com/resources/nedzicom_topics/?SelectedLanguage=ja-JP)。内容が面白い。この前の攪拌の奴もそうだけど、分かりやすく書こうと努力しつつ結局内容がガチになるところが良い。こういうのが増えていくと素敵だな、と思う。

## [03月13日(土)](#13) <a id="13"></a>

Rubyのヒアドキュメント中に引用符を書きたい場合がある。こんなの。

```rb
t = [1, 2, 3]
puts <<"TEST"
#{t.join(",")}
TEST
```

ここで`t.join(",")`の引用符を、Rubocopはデフォルトでシングルクォーツにしろと怒ってくる。

```txt
test.rb:3:10: C: Style/StringLiteralsInInterpolation: Prefer single-quoted strings inside interpolations.
#{t.join(",")}
         ^^^
```

でも、rufoはここをデフォルトでダブルクォーツに直してくる。VimのALEがチェックにrubocopを、フォーマッタにrufoを使うので、保存時にrufoが直してはrubocopが怒る、というループになる。

結局、`.rubocop.yml`に

```yaml
Style/StringLiteralsInInterpolation:
  EnforcedStyle: double_quotes
```

と書いて、rubocopをrufoに歩み寄らせた。

## [03月12日(金)](#12) <a id="12"></a>

論文の図の修正。共著者さんの結果を自分の結果に入れ替え。ものすごく時間かかったぞ。

追加計算用コードを書いてスパコンに投げた。cos(4π/3)の符号を間違えていたせいでしばらく混乱していた。ひどいもんだ。

WSL2でtmuxを使うと激重になるの、Windowsのパスが通っているせいだったらしい。[ここ](https://amaya382.hatenablog.jp/entry/2019/12/27/120057)の記述にしたがって`/etc/wsl.conf`に

```txt
[interop]
appendWindowsPath = false
```

と書いてログインしなおせばかなり早くなる。ただし、当然のことながらWindowsから引き継いだパスに由来するコードが使えなくなるので、自分で設定するかシンボリックリンクが必要。特に`code`が使えなくなるのが面倒。他にも副作用がありそうなので、とりあえず元に戻した。tmuxはしばらくあきらめよう。

tmuxとの関連は不明だが、なんかシェルが死んで、WSLを再起動したら

```sh
zsh: corrupt history file /home/myusername/.zsh_history
```

とか言われてzshが動かなくなった。[ここ](https://superuser.com/questions/957913/how-to-fix-and-recover-a-corrupt-history-file-in-zsh)の記述の通り、

```sh
mv .zsh_history .zsh_history_bad
strings .zsh_history_bad > .zsh_history
```

で解決。

## [03月11日(木)](#11) <a id="11"></a>

Vimハンズオン。

研究室ミーティング。

本読み輪講。余談として、ルジャンドル変換と幾何学的な双対について。

## [03月10日(水)](#10) <a id="10"></a>

論文の図を直してた。

## [03月09日(火)](#09) <a id="09"></a>

免許の住所変更した。

マイナンバーカード4人分申請した。

論文を書こうとしたのだが、なんかWSL2でビルドできない。あと、texindentを入れようとしたら、tlmgrが古いとか言われる。

```sh
$ tlmgr update --self
(running on Debian, switching to user mode!)
tlmgr: Remote repository is newer than local (2017 < 2020)
Cross release updates are only supported with
  update-tlmgr-latest(.sh/.exe) --update
Please see https://tug.org/texlive/upgrade.html for details.
```

```sh
$ sudo apt update
$ sudo apt upgrade
```

でも、upgradableを見る限りTeXLiveは入っていない気がする？フルインストールしちゃえ。

```sh
sudo apt install texlive-full
```

Windowsだと死ぬほど時間かかるけど、WSL2だとどうだろう？

入った。これでlatexindentが入るかな？

```sh
$ latexindent --version
3.4.1, 2018-01-18
```

入ったみたい。

ダメだ。WindowsのWSL:UbuntuでVS CodeからLaTeX Buildしようとしてもどうしてもうまくいかない。実行マークが永遠にくるくる回るだけ。VS Codeのターミナルから開いて実行したらうまくいくのだが。

やむを得ず、VS Code保存時のビルドを切った。

```json
{
    "latex-workshop.latex.autoBuild.run": "never",
}
```

## [03月08日(月)](#08) <a id="08"></a>

予算締めた。

卒論郵送した。一言コメント付き。

学科のビデオカメラをコンバータ経由でWebexで配信、録画してみた。問題なくできた。これで物情特別講義OK。

スパコンが一つメンテ中で、もう一つはジョブの実行待ち。なんかエアポケットのようになってしまった。講義の準備とかいろいろあるのだが、なんかうまく切り替えられなかった。

## [03月07日(日)](#07) <a id="07"></a>

NOP

## [03月06日(土)](#06) <a id="06"></a>

NOP

## [03月05日(金)](#05) <a id="05"></a>

最近はそれなりに睡眠時間がとれているせいか、頭がよく回る気がする。

必要なプログラムをすべてJackknife化して、物性研に投げた。

もう一つのスパコンのデバッグをしようと思ったんだけど、ファイルシステムが重くてなんにもできない。なにこれ？

## [03月04日(木)](#04) <a id="04"></a>

ハンズオン。論文の読み方。自宅から大学が契約する論文を読むための手続きなど。

研究室ミーティング。

輪講。

TAの募集出した。

ん？なんか3日前のActionがQueuedのままになってるぞ。なんでだ？

## [03月03日(水)](#03) <a id="03"></a>

在宅勤務。明日の輪講の準備。あとハンズオン。

## [03月02日(火)](#02) <a id="02"></a>

Macのg++-10がいつのまにか使えなくなっていたのに対応。

現象。

```sh
$ g++-10 test.cpp 
In file included from /usr/local/Cellar/gcc/10.1.0/include/c++/10.1.0/bits/stl_algo.h:59,
                 from /usr/local/Cellar/gcc/10.1.0/include/c++/10.1.0/algorithm:62,
                 from ../sdouble.hpp:29,
                 from test.cpp:1:
/usr/local/Cellar/gcc/10.1.0/include/c++/10.1.0/cstdlib:75:15: fatal error: stdlib.h: No such file or directory
   75 | #include_next <stdlib.h>
      |               ^~~~~~~~~~
compilation terminated.
```

などと言われ、ヘッダファイルのパスが見つからない。アンインストールしようとしたら、

```sh
$ brew uninstall gcc
Error: Refusing to uninstall /usr/local/Cellar/gcc/10.1.0
because it is required by boost-mpi, fftw, kim-api, lammps, open-mpi, openblas and r, which are currently installed.
You can override this and force removal with:
  brew uninstall --ignore-dependencies gcc
```

などと怒られたので、再インストールしてみる。

```sh
brew reinstall gcc
```

```sh
g++-10 test.cpp
```

コンパイルして、ヘッダが見つからないと言われないことを確認。なおってよかった。

なんかデフォルトブランチがmainとmasterが混在していて鬱陶しいので少しずつmainに修正。

`stat::sdouble`ライブラリを修正。やっぱり`<<`で値を追加する必要はないと判断。普通に`std::vector<double>`を使うことにして、ライブラリでは誤差伝搬だけを考えることにする。

## [03月01日(月)](#01) <a id="01"></a>

え？もう三月なの？マジで？

一応「日記」も足掛け5ヶ月目になるのか(11/18スタートだからまだ4ヶ月分書いてないけど)。これなら三日坊主にはなってないかな。

学振PD受け入れ書類提出。ちょっと遅れてしまった。申し訳ない。

「スパコンで食えるか(仮)」みたいなタイトルで話すことに。ほんとにこのタイトルで行くかは謎。

新年度の準備。輪講とハンズオンの連絡とか。論文紹介用の論文もリストアップしておかないとな。

みずほのATMに障害。関連してSuicaシステムは優れているという話を聞いてちょっと調べた。[Suicaシステムの概要(pdf)](https://www.jstage.jst.go.jp/article/ieiej/31/6/31_408/_pdf/-char/en)。普通にシステムを組むなら不正利用を防ぐためにカードにはIDだけ入れておいて、サーバに情報をすべて置いて置きたくなるが、それだとサーバが死んだら完全に交通が麻痺してしまうため、カード内、各駅のサーバ、そしてセンターサーバそれぞれに情報を貯める自立分散システムを構築。センターサーバと駅サーバの回線が切れたり、センターサーバが死んでも一部の業務を除いて運用継続が可能。また、ラッシュアワーなど、通信負荷がかかる場合でも、駅サーバが「キャッシュ」の役割を果たし、後でサーバと同期を取ることでセンターサーバの負担を軽減する。なるほど。

Suicaに比べて不正操作の影響が大きい銀行ATMと直接比べることはできないが、たしかによくできたシステム。

プリンタ、キャプチャデバイスの見積もり依頼。キャプチャデバイスはZoomとハンディカムの接続用。届いたらテストしなくては。

忘れてた。いつの間にかMacでgit submoduleが使えなくなっていたんだ。忙しくて放置していた。

```sh
$ git submodule update --init --recursive 
pyenv: git-submodule: command not found
```

とにかく困るので対処。

```sh
$ which git
/usr/local/bin/git

$ git --version
git version 2.30.0

$ brew uninstall git
Uninstalling /usr/local/Cellar/git/2.30.0... (1,486 files, 40.5MB)

Warning: The following may be git configuration files and have not been removed!
If desired, remove them manually with `rm -rf`:
  /usr/local/etc/gitconfig

$ rm -rf /usr/local/etc/gitconfig

$ which git
/usr/bin/git

$ git --version
git version 2.24.3 (Apple Git-128)
```

あるやん。brewで入れたgitが`/usr/local/bin/git`に入っており、そいつが問題をおこしていた？

Gitのバージョンは下がったが、submoduleは使えるようになった。

Jackknifeによるバイアス補正、物性研にジョブ投げたぞ。これでうまく行ってそうなら本番コードを全部修正してデータを再取得しておしまいだ。
