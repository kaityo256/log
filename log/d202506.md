# 2025年6月

## [06月06日(金)](#06) <a id="06"></a>

物性研スパコンでのLAMMPSのバルクジョブのサンプルコード書いた。

[LAMMPS Bulk Job Sample](https://github.com/kaityo256/lammps_bulkjob_sample)

すぐできると思ったが、思ったより時間かかったな。シェルスクリプトの実行時間を知るための`SECONDS`変数を初めて知った。bashの特殊変数のようだ。zshにもあるみたい。

lammpstrjの解析用C++ヘッダも途中まで作った。

[kaityo256/lammpstrj-parser](https://github.com/kaityo256/lammpstrj-parser)

関数オブジェクトやコールバック関数みたいなやつ、最近はどうするんですか？って聞いたら`std::function`ですって。C++11らしい。何も知らんかった。

## [06月05日(木)](#05) <a id="05"></a>

[モダンCMake入門](https://tnishinaga.hatenablog.com/entry/2025/06/04/025151)

CMakeはVer. 2.8.xまではディレクトリベースだったが、3.0系からターゲットベースに変更されたらしい。Makefileでもひぃひぃ言ってるのに、CMakeもモダンな書き方が出たとか。

あとPythonも最近はpyenvじゃなくてuv使うの？

技術の進展が早すぎておいちゃんついていけないよ・・・

教授・准教授就任記念講演、明日だったわ。

ChatGPTのこと「チャッピー」と呼ぶらしい。

チャッピーに論文の英訳させてたら、それまで淡々と英訳してたのが「あなたは不安定領域と言ったけれど、この領域は安定領域じゃないでしょうか？」と訂正してきて震えた(この指摘は正しい)。マジか。

久々に予定がほとんどない日。ずっと論文修正。集中力の欠如に苦しんだが、とりあえず結果を修正した。あと残るセクション1つ。頑張る。

## [06月04日(水)](#04) <a id="04"></a>

物性研にSLATEをインストール。

```sh
cd build
git clone --recursive https://github.com/icl-utk-edu/slate.git
cd slate
mkdir build
cd build
cmake -Dblas=mkl -Dbuild_tests=no -DCMAKE_INSTALL_PREFIX=/usr/local
```

```sh
module purge
module load oneapi_compiler oneapi_mpi oneapi_mkl
```

```sh
$ mpiicpc --version
icpc (ICC) 2021.8.0 20221119
Copyright (C) 1985-2022 Intel Corporation.  All rights reserved.
```

```sh
export CXX=mpiicpc
export FC=mpiifort
cmake -Dblas=mkl -Dbuild_tests=no -Dgpu_backend=none -DCMAKE_INSTALL_PREFIX=$HOME/usr/local ..
```

```txt
CMake Error at blaspp/CMakeLists.txt:8 (cmake_minimum_required):
  CMake 3.21 or higher is required.  You are running version 3.19.2
```

CMakeが古いな。自分が入れた古いのを見てた。やりなおし。

```txt
CMake Error at blaspp/CMakeLists.txt:8 (cmake_minimum_required):
  CMake 3.21 or higher is required.  You are running version 3.20.2
```

まだ古い。

```sh
cd build
wget https://github.com/Kitware/CMake/releases/download/v4.0.2/cmake-4.0.2-linux-x86_64.tar.gz
tar xvzf cmake-4.0.2-linux-x86_64.tar.gz 
cd cmake-4.0.2-linux-x86_64/
cp bin/* ~/usr/local/bin/
'cp' -r share ~/usr/local
export PATH=~/usr/local/bin:$PATH
export CMAKE_ROOT=~/usr/local
```

```sh
$ cmake --version
cmake version 4.0.2

CMake suite maintained and supported by Kitware (kitware.com/cmake).
```

よろしい。改めて。

```sh
cd build
export CXX=mpiicpc
export FC=mpiifort
cmake -Dblas=mkl -Dbuild_tests=no -Dgpu_backend=none -DCMAKE_INSTALL_PREFIX=$HOME/usr/local ..
make
```

```sh
$ /opt/intel/oneapi/mpi/2021.8.0/bin/mpiicpc -DSLATE_ID=\"f8348a7c\" -Dslate_EXPORTS -I/home/k0117/k011700/build/slate/include -I/home/k0117/k011700/build/slate/src -I/home/k0117/k011700/build/slate/build/blaspp/include -I/home/k0117/k011700/build/slate/blaspp/include -I/home/k0117/k011700/build/slate/build/lapackpp/include -I/home/k0117/k011700/build/slate/lapackpp/include -std=c++17 -fPIC -qopenmp -MD -MT CMakeFiles/slate.dir/src/hemmA.cc.o -MF CMakeFiles/slate.dir/src/hemmA.cc.o.d -o CMakeFiles/slate.dir/src/hemmA.cc.o -c /home/k0117/k011700/build/slate/src/hemmA.cc

/home/k0117/k011700/build/slate/src/hemmA.cc(305): error: unsupported lvalue expression on locator-list
              #pragma omp task depend(in:gemm[A.nt()-1])
                                         ^
          detected during instantiation of "void slate::hemmA(blas::Side, scalar_t, slate::HermitianMatrix<scalar_t> &, slate::Matrix<scalar_t> &, scalar_t, slate::Matrix<scalar_t> &, const slate::Options &) [with scalar_t=float]" at line 673

/home/k0117/k011700/build/slate/src/hemmA.cc(553): error: unsupported lvalue expression on locator-list
              #pragma omp task depend(in:gemm[A.nt()-1])
                                         ^
          detected during instantiation of "void slate::hemmA(blas::Side, scalar_t, slate::HermitianMatrix<scalar_t> &, slate::Matrix<scalar_t> &, scalar_t, slate::Matrix<scalar_t> &, const slate::Options &) [with scalar_t=float]" at line 673

compilation aborted for /home/k0117/k011700/build/slate/src/hemmA.cc (code 2)
```

エラーだな。


```sh
g++ -DSLATE_ID=\"f8348a7c\" -Dslate_EXPORTS -I/home/k0117/k011700/build/slate/include -I/home/k0117/k011700/build/slate/src -I/home/k0117/k011700/build/slate/build/blaspp/include -I/home/k0117/k011700/build/slate/blaspp/include -I/home/k0117/k011700/build/slate/build/lapackpp/include -I/home/k0117/k011700/build/slate/lapackpp/include -std=c++17 -fPIC -fopenmp -MD -MT CMakeFiles/slate.dir/src/hemmA.cc.o -MF CMakeFiles/slate.dir/src/hemmA.cc.o.d -o CMakeFiles/slate.dir/src/hemmA.cc.o -c /home/k0117/k011700/build/slate/src/hemmA.cc
```

通る。

```sh
git clone --recursive https://github.com/icl-utk-edu/slate.git
cd slate
mkdir build
cd build
export CXX=mpicxx
export FC=mpiifort
cmake -Dblas=mkl -Dbuild_tests=no -Dgpu_backend=none -DCMAKE_INSTALL_PREFIX=$HOME/usr/local ..
```

一応ビルドは通ったが・・・？

等周問題を考えたが、意外に難しい。うーむ。

査読した結果が次々返ってくる。他の査読者のコメント、参考になる。

## [06月03日(火)](#03) <a id="03"></a>

輪講。渡辺解析力学(ハチワレ解析力学)の3章の問題。拘束条件付き変分原理におけるラグランジュの未定乗数の意味とか。

分子シミュレーション研究創発センターキックオフミーティング(A)。

VS CodeにGoの拡張機能を追加。「Go for Visual Studio Code」かな。

インストール後、コマンドパレットから「Go: Install/Update tools」を実行して、現れたツールを全て選んでアップデート。

## [06月02日(月)](#02) <a id="02"></a>

「やりたいことが多すぎて、でも時間が足りなくて、どうしても『やりたいのにやらないと決めたこと』が出てくるが、どうすればよいか」という質問。いや、どうすれば良いか僕も知りたい。やりたいことが多すぎるのに忙しすぎる。

1on1中にお腹が痛くなって、早めに切り上げたい感じが出てしまって申し訳なかった。

シミュレーション工学。自分の担当最後。

物性研後期申請した。

シミュレーション工学のレポートのヒントアップロードした。来年からどうするかなぁ、これ。

## [06月01日(日)](#01) <a id="01"></a>

もう6月か。いつも月が変わるたびに、何もできないまま月日が流れることに焦る。焦るというか、諦めというか

息子の幼馴染の劇を鑑賞しに千葉へ。幼稚園からの付き合い。二人とも大きくなったね。

帰りに渋滞に巻き込まれて疲れた。

シミュレーション工学の感想の返事書いたり。物性研の申請を書くのはちょっと無理だった。
